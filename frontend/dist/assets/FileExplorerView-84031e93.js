import{v as ae,a4 as a,a6 as f,a7 as R,a8 as e,E as P,A as t,_ as n,W as m,u as c,ad as J,B as Ee,ab as L,ac as q,F as W,r as G,w as ie,ai as Ue,c as O,k as Ve,aa as Ke,a as ce}from"./vue-3f691d55.js";import{_ as pe}from"./_plugin-vue_export-helper-c27b6911.js";import{c as H,u as Xe,l as ee,m as Ze}from"./apollo-30a378f4.js";import{b as he,a as et}from"./index-cc140e55.js";import"./supabase-cf010ec4.js";function me(){const k=[{title:"Name",key:"name",sortable:!0},{title:"MIME",key:"mimeType",sortable:!0},{title:"Size",key:"size",sortable:!0},{title:"Updated",key:"updatedAt",sortable:!0},{title:"",key:"actions",sortable:!1}],v=[{key:"current",label:"Current",icon:"mdi-check-circle"},{key:"deleted",label:"Deleted",icon:"mdi-delete"}],w=[{value:"PENDING",label:"Pending"},{value:"CLASSIFIED",label:"Classified"},{value:"MANUAL_REVIEW",label:"Manual review"},{value:"FAILED",label:"Failed"}],M=[{value:"application/pdf",label:"PDF"},{value:"image/jpeg",label:"JPEG"},{value:"image/png",label:"PNG"},{value:"text/plain",label:"Text"},{value:"application/json",label:"JSON"}];function C(i){switch(i.toLowerCase()){case"dropbox":return"blue";case"googledrive":return"green";default:return"grey"}}function z(i){switch(i.toLowerCase()){case"dropbox":return"mdi-dropbox";case"googledrive":return"mdi-google-drive";default:return"mdi-cloud"}}function x(i){const o=["Bytes","KB","MB","GB"];if(i===0)return"0 Bytes";const d=Math.floor(Math.log(i)/Math.log(1024));return Math.round(i/Math.pow(1024,d)*100)/100+" "+o[d]}function b(i){return new Date(i).toLocaleDateString()}function y(i){switch((i||"").toUpperCase()){case"CLASSIFIED":return"green";case"MANUAL_REVIEW":return"orange";case"FAILED":return"red";default:return"grey"}}function u(i){return i?i.startsWith("image/")?"mdi-file-image":i.startsWith("video/")?"mdi-file-video":i.startsWith("audio/")?"mdi-file-music":i==="application/pdf"?"mdi-file-pdf-box":i.startsWith("text/")?"mdi-file-document":"mdi-file":"mdi-file"}return{fileHeaders:k,fileFilters:v,classificationOptions:w,mimeOptions:M,getProviderColor:C,getProviderIcon:z,formatFileSize:x,formatDate:b,classificationColor:y,mimeIcon:u}}const tt={class:"d-flex align-center"},lt=ae({__name:"FileTable",props:{filteredFiles:{},loading:{type:Boolean},renameFile:{},moveFile:{},downloadFile:{},openInProvider:{}},emits:["fileSelect"],setup(k,{emit:v}){const w=v,{fileHeaders:M,formatFileSize:C,formatDate:z,mimeIcon:x}=me();function b(i,{item:o}){w("fileSelect",o)}function y(i,o){const d=window.prompt("Rename file",i.name);d&&d!==i.name&&o(i.id,d)}function u(i,o){const d=window.prompt("Move file to path",i.path);d&&d!==i.path&&o(i.id,d)}return(i,o)=>{const d=a("v-icon"),V=a("v-chip"),F=a("v-btn"),s=a("v-list-item-title"),p=a("v-list-item"),E=a("v-list"),T=a("v-menu"),_=a("v-data-table");return f(),R(_,{headers:c(M),items:i.filteredFiles,loading:i.loading,density:"compact",class:"elevation-1","onClick:row":b},{"item.name":e(({item:I})=>[P("div",tt,[t(d,{size:"small",class:"mr-2"},{default:e(()=>[n(m(c(x)(I.mimeType)),1)]),_:2},1024),P("span",null,m(I.name),1)])]),"item.mimeType":e(({item:I})=>[I.mimeType?(f(),R(V,{key:0,size:"x-small",variant:"tonal"},{default:e(()=>[n(m(I.mimeType),1)]),_:2},1024)):J("",!0)]),"item.size":e(({item:I})=>[n(m(c(C)(I.size||0)),1)]),"item.updatedAt":e(({item:I})=>[n(m(c(z)(I.updatedAt||"")),1)]),"item.actions":e(({item:I})=>[t(T,null,{activator:e(({props:U})=>[t(F,Ee({icon:"",variant:"text",size:"small"},U),{default:e(()=>[t(d,null,{default:e(()=>o[0]||(o[0]=[n("mdi-dots-vertical",-1)])),_:1,__:[0]})]),_:2},1040)]),default:e(()=>[t(E,{density:"compact"},{default:e(()=>[t(p,{onClick:U=>y(I,i.renameFile)},{prepend:e(()=>[t(d,null,{default:e(()=>o[1]||(o[1]=[n("mdi-pencil",-1)])),_:1,__:[1]})]),default:e(()=>[t(s,null,{default:e(()=>o[2]||(o[2]=[n("Rename",-1)])),_:1,__:[2]})]),_:2},1032,["onClick"]),t(p,{onClick:U=>u(I,i.moveFile)},{prepend:e(()=>[t(d,null,{default:e(()=>o[3]||(o[3]=[n("mdi-folder-move",-1)])),_:1,__:[3]})]),default:e(()=>[t(s,null,{default:e(()=>o[4]||(o[4]=[n("Move",-1)])),_:1,__:[4]})]),_:2},1032,["onClick"]),t(p,{onClick:U=>i.downloadFile(I.id)},{prepend:e(()=>[t(d,null,{default:e(()=>o[5]||(o[5]=[n("mdi-download",-1)])),_:1,__:[5]})]),default:e(()=>[t(s,null,{default:e(()=>o[6]||(o[6]=[n("Download",-1)])),_:1,__:[6]})]),_:2},1032,["onClick"]),t(p,{onClick:U=>i.openInProvider(I.id)},{prepend:e(()=>[t(d,null,{default:e(()=>o[7]||(o[7]=[n("mdi-open-in-new",-1)])),_:1,__:[7]})]),default:e(()=>[t(s,null,{default:e(()=>o[8]||(o[8]=[n("Open in Provider",-1)])),_:1,__:[8]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["headers","items","loading"])}}});const nt=pe(lt,[["__scopeId","data-v-328030e5"]]),ot={class:"text-subtitle-2 mb-2"},it={key:0,class:"ml-2 text-medium-emphasis"},at={class:"mt-4 d-flex gap-2"},st={class:"text-left"},dt=ae({__name:"FileInspector",props:{selectedFile:{},actionLoading:{type:Boolean},showClassify:{type:Boolean},classificationOptions:{},mimeOptions:{}},emits:["triggerReprocess","showClassify","applyClassificationFilter","applyMimeFilter"],setup(k,{emit:v}){const w=v,{formatFileSize:M,formatDate:C,classificationColor:z,mimeIcon:x}=me();function b(){w("triggerReprocess")}function y(i){w("applyClassificationFilter",i)}function u(i){w("applyMimeFilter",i)}return(i,o)=>{const d=a("v-icon"),V=a("v-card-title"),F=a("v-list-item-title"),s=a("v-list-item-subtitle"),p=a("v-list-item"),E=a("v-chip"),T=a("v-list"),_=a("v-btn"),I=a("v-card-text"),U=a("v-card"),Q=a("v-divider"),te=a("v-list-subheader");return i.selectedFile?(f(),R(U,{key:0,class:"glass-card"},{default:e(()=>[t(V,null,{default:e(()=>[t(d,{class:"mr-2"},{default:e(()=>o[1]||(o[1]=[n(" mdi-information ",-1)])),_:1,__:[1]}),o[2]||(o[2]=n(" Inspector ",-1))]),_:1,__:[2]}),t(I,null,{default:e(()=>{var N,Z;return[P("h4",ot,m(i.selectedFile.name),1),t(T,{density:"compact"},{default:e(()=>{var K;return[t(p,null,{default:e(()=>[t(F,null,{default:e(()=>o[3]||(o[3]=[n("Size",-1)])),_:1,__:[3]}),t(s,null,{default:e(()=>[n(m(c(M)(i.selectedFile.size||0)),1)]),_:1})]),_:1}),t(p,null,{default:e(()=>[t(F,null,{default:e(()=>o[4]||(o[4]=[n("Updated",-1)])),_:1,__:[4]}),t(s,null,{default:e(()=>[n(m(c(C)(i.selectedFile.updatedAt||"")),1)]),_:1})]),_:1}),t(p,null,{default:e(()=>[t(F,null,{default:e(()=>o[5]||(o[5]=[n("Path",-1)])),_:1,__:[5]}),t(s,{class:"text-wrap"},{default:e(()=>[n(m(i.selectedFile.path),1)]),_:1})]),_:1}),t(p,null,{default:e(()=>[t(F,null,{default:e(()=>o[6]||(o[6]=[n("MIME",-1)])),_:1,__:[6]}),t(s,{class:"text-wrap"},{default:e(()=>[n(m(i.selectedFile.mimeType),1)]),_:1})]),_:1}),(K=i.selectedFile.metadata)!=null&&K.preview||i.selectedFile.extractedText?(f(),R(p,{key:0},{default:e(()=>[t(F,null,{default:e(()=>o[7]||(o[7]=[n("Preview",-1)])),_:1,__:[7]}),t(s,{class:"text-wrap",style:{"white-space":"pre-wrap","max-height":"240px",overflow:"auto"}},{default:e(()=>{var Y;return[n(m(((Y=i.selectedFile.metadata)==null?void 0:Y.preview)||i.selectedFile.extractedText),1)]}),_:1})]),_:1})):J("",!0),t(p,null,{default:e(()=>[t(F,null,{default:e(()=>o[8]||(o[8]=[n("Classification",-1)])),_:1,__:[8]}),t(s,null,{default:e(()=>[t(E,{color:c(z)(i.selectedFile.classificationStatus),size:"small",label:"",variant:"tonal"},{default:e(()=>[n(m(i.selectedFile.classificationStatus),1)]),_:1},8,["color"]),i.selectedFile.classificationConfidence?(f(),L("span",it,m((i.selectedFile.classificationConfidence*100).toFixed(0))+"% ",1)):J("",!0)]),_:1})]),_:1}),i.selectedFile.canonicalSlot?(f(),R(p,{key:1},{default:e(()=>[t(F,null,{default:e(()=>o[9]||(o[9]=[n("Canonical Slot",-1)])),_:1,__:[9]}),t(s,null,{default:e(()=>[n(m(i.selectedFile.canonicalSlot),1)]),_:1})]),_:1})):J("",!0)]}),_:1}),P("div",at,[t(_,{color:"primary","prepend-icon":"mdi-refresh",loading:i.actionLoading,onClick:b},{default:e(()=>o[10]||(o[10]=[n(" Reprocess ",-1)])),_:1,__:[10]},8,["loading"]),t(_,{color:"secondary","prepend-icon":"mdi-tag",onClick:o[0]||(o[0]=K=>w("showClassify",!0))},{default:e(()=>o[11]||(o[11]=[n(" Classify ",-1)])),_:1,__:[11]}),(N=i.selectedFile.metadata)!=null&&N.downloadUrl?(f(),R(_,{key:0,href:i.selectedFile.metadata.downloadUrl,target:"_blank","prepend-icon":"mdi-download"},{default:e(()=>o[12]||(o[12]=[n(" Download ",-1)])),_:1,__:[12]},8,["href"])):J("",!0),(Z=i.selectedFile.metadata)!=null&&Z.previewUrl?(f(),R(_,{key:1,href:i.selectedFile.metadata.previewUrl,target:"_blank","prepend-icon":"mdi-open-in-new"},{default:e(()=>o[13]||(o[13]=[n(" Open Preview ",-1)])),_:1,__:[13]},8,["href"])):J("",!0)])]}),_:1})]),_:1})):(f(),R(U,{key:1,class:"text-center pa-8 glass-card"},{default:e(()=>[t(d,{size:"48",color:"grey-lighten-1"},{default:e(()=>o[14]||(o[14]=[n(" mdi-cursor-default-click ",-1)])),_:1,__:[14]}),o[19]||(o[19]=P("p",{class:"text-medium-emphasis mt-2"}," Select a file to view details ",-1)),t(Q,{class:"my-4"}),P("div",st,[o[18]||(o[18]=P("div",{class:"text-subtitle-2 mb-2"}," Facets ",-1)),t(T,{density:"compact"},{default:e(()=>[t(te,null,{default:e(()=>o[15]||(o[15]=[n("Classification",-1)])),_:1,__:[15]}),(f(!0),L(W,null,q(i.classificationOptions,N=>(f(),R(p,{key:N.value,onClick:Z=>y(N.value)},{prepend:e(()=>[t(d,{size:"x-small"},{default:e(()=>o[16]||(o[16]=[n(" mdi-tag ",-1)])),_:1,__:[16]})]),default:e(()=>[t(F,null,{default:e(()=>[n(m(N.label),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(Q,{class:"my-2"}),t(te,null,{default:e(()=>o[17]||(o[17]=[n("MIME Type",-1)])),_:1,__:[17]}),(f(!0),L(W,null,q(i.mimeOptions,N=>(f(),R(p,{key:N.value,onClick:Z=>u(N.value)},{prepend:e(()=>[t(d,{size:"x-small"},{default:e(()=>[n(m(c(x)(N.value)),1)]),_:2},1024)]),default:e(()=>[t(F,null,{default:e(()=>[n(m(N.label),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])]),_:1,__:[19]}))}}});const rt=pe(dt,[["__scopeId","data-v-186765a5"]]),ut=ae({__name:"ClassifyDialog",props:{modelValue:{type:Boolean},actionLoading:{type:Boolean},canonicalSlots:{},form:{}},emits:["update:modelValue","submitClassification"],setup(k,{emit:v}){const w=k,M=v,C=G(w.modelValue);ie(()=>w.modelValue,b=>{C.value=b}),ie(C,b=>{M("update:modelValue",b)});function z(){C.value=!1}function x(){M("submitClassification")}return(b,y)=>{const u=a("v-icon"),i=a("v-card-title"),o=a("v-select"),d=a("v-slider"),V=a("v-card-text"),F=a("v-spacer"),s=a("v-btn"),p=a("v-card-actions"),E=a("v-card"),T=a("v-dialog");return f(),R(T,{modelValue:C.value,"onUpdate:modelValue":y[2]||(y[2]=_=>C.value=_),"max-width":"500"},{default:e(()=>[t(E,{class:"glass-card"},{default:e(()=>[t(i,null,{default:e(()=>[t(u,{class:"mr-2"},{default:e(()=>y[3]||(y[3]=[n(" mdi-tag ",-1)])),_:1,__:[3]}),y[4]||(y[4]=n(" Classify File ",-1))]),_:1,__:[4]}),t(V,null,{default:e(()=>[t(o,{modelValue:b.form.canonicalSlot,"onUpdate:modelValue":y[0]||(y[0]=_=>b.form.canonicalSlot=_),items:b.canonicalSlots,"item-title":"key","item-value":"key",label:"Canonical Slot"},null,8,["modelValue","items"]),t(d,{modelValue:b.form.confidence,"onUpdate:modelValue":y[1]||(y[1]=_=>b.form.confidence=_),min:"0",max:"1",step:"0.01",label:"Confidence",class:"mt-4"},null,8,["modelValue"])]),_:1}),t(p,null,{default:e(()=>[t(F),t(s,{variant:"text",onClick:z},{default:e(()=>y[5]||(y[5]=[n(" Cancel ",-1)])),_:1,__:[5]}),t(s,{color:"primary",loading:b.actionLoading,onClick:x},{default:e(()=>y[6]||(y[6]=[n(" Save ",-1)])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const ct=pe(ut,[["__scopeId","data-v-d645b130"]]);function pt(){Ue();const k=G({viewMode:"source",fileViewMode:"table",searchQuery:"",selectedFolders:[],openedFolders:["root"],selectedFiles:[],selectedFile:null,selectedFilters:[],syncStatus:"idle",showUploadDialog:!1,currentProvider:"Unknown",actionLoading:!1,showClassify:!1,entityGroupBy:"project"}),v=G([]),w=O(()=>k.value.entityGroupBy==="project"?"mdi-view-module":"mdi-cloud");return{state:k,folderTree:v,entityGroupIcon:w}}const mt=H`
  query Files($filter: FileFilter, $limit: Int, $offset: Int) {
    files(filter: $filter, limit: $limit, offset: $offset) {
      id
      orgId
      sourceId
      projectId
      path
      name
      size
      mimeType
      updatedAt
      metadata
      classificationStatus
      classificationConfidence
      canonicalSlot
      current
      deleted
      project { id name }
      source { id name provider }
    }
  }
`,ft=H`
  subscription OnFileUpdated($orgId: ID!) {
    fileUpdated(orgId: $orgId) {
      id
      orgId
      sourceId
      projectId
      path
      name
      size
      mimeType
      updatedAt
      metadata
      classificationStatus
      classificationConfidence
      canonicalSlot
      current
      deleted
    }
  }
`,vt=H`
  mutation RenameFile($orgId: ID!, $id: ID!, $name: String!) {
    renameFile(orgId: $orgId, id: $id, name: $name) {
      id
      name
      path
    }
  }
`,_t=H`
  mutation MoveFile($orgId: ID!, $id: ID!, $path: String!) {
    moveFile(orgId: $orgId, id: $id, path: $path) {
      id
      name
      path
    }
  }
`;function De(){var F;const k=he(),v=G({filter:{orgId:((F=k.currentOrg)==null?void 0:F.id)||"",sourceId:void 0,classificationStatus:void 0,mimeType:void 0,path:void 0,name:void 0},limit:200,offset:0}),{result:w,loading:M,refetch:C,onError:z}=Xe(mt,v),x=G([]),{mutate:b}=ee(vt),{mutate:y}=ee(_t);Ve(()=>{var s;v.value.filter.orgId=((s=k.currentOrg)==null?void 0:s.id)||""}),Ve(()=>{var s;(s=w.value)!=null&&s.files&&(x.value=w.value.files)});const{onResult:u}=Ze(ft,()=>{var s;return{orgId:((s=k.currentOrg)==null?void 0:s.id)||""}});u(s=>{var T;const p=(T=s.data)==null?void 0:T.fileUpdated;if(!p)return;const E=x.value.findIndex(_=>_.id===p.id);E>=0?x.value[E]={...x.value[E],...p}:x.value.unshift(p)});async function i(s,p){await b({orgId:v.value.filter.orgId,id:s,name:p}),await C()}async function o(s,p){await y({orgId:v.value.filter.orgId,id:s,path:p}),await C()}function d(s){var E;const p=(E=s==null?void 0:s.metadata)==null?void 0:E.downloadUrl;p&&window.open(p,"_blank")}function V(s){var E,T;const p=((E=s==null?void 0:s.metadata)==null?void 0:E.providerUrl)||((T=s==null?void 0:s.metadata)==null?void 0:T.previewUrl);p&&window.open(p,"_blank")}return{items:x,loading:M,refetch:C,onError:z,variables:v,renameFile:i,moveFile:o,downloadFile:d,openInProvider:V}}function gt(k,v){const{items:w,loading:M,renameFile:C,moveFile:z,downloadFile:x,openInProvider:b}=De(),y=G("");ie(y,d=>{k.value.filter.name=d||void 0,k.value.filter.path=d||void 0,v()});const u=O(()=>{const d={};return w.value.forEach(V=>{const F=V.canonicalSlot||"Unassigned";d[F]=d[F]||[],d[F].push(V)}),d}),i=O(()=>{const d=[],V=u.value;return Object.keys(V).forEach(F=>d.push({key:F,items:V[F]})),d}),o=O(()=>{let d=w.value;if(y.value){const V=y.value.toLowerCase();d=d.filter(F=>F.name.toLowerCase().includes(V)||F.path.toLowerCase().includes(V))}return d});return{items:w,loading:M,searchQuery:y,filesByCanonical:u,filesByCanonicalList:i,filteredFiles:o,renameFile:C,moveFile:z,downloadFile:x,openInProvider:b}}function yt(){const k=H`
    mutation TriggerFileReprocessing($fileId: ID!, $orgId: ID!) {
      triggerFileReprocessing(fileId: $fileId, orgId: $orgId)
    }
  `,v=H`
    mutation ClassifyFile($input: ClassifyFileInput!) {
      classifyFile(input: $input) {
        id
        classificationStatus
        classificationConfidence
        canonicalSlot
        updatedAt
      }
    }
  `,w=H`
    mutation TriggerFullSync($orgId: ID!) { 
      triggerFullSync(orgId: $orgId) 
    }
  `,M=H`
    query CanonicalSlots($orgId: ID!) {
      canonicalSlots(orgId: $orgId) { key }
    }
  `,{mutate:C}=ee(k),{mutate:z}=ee(v),{mutate:x}=ee(w);return{triggerReprocessMutate:C,classifyMutate:z,triggerFullSync:x,CANONICAL_SLOTS_QUERY:M}}function Ft(k,v,w,M,C,z,x){const b=Ue(),y=Ke(),u=et(),i=G(!1),o=G(!1),d=G([]);async function V(){if(k.value){i.value=!0;try{await C({fileId:k.value.id,orgId:v.value[0]&&v.value[0].orgId||""}),u.add("success","Reprocessing triggered")}catch(_){u.add("error",_.message||"Failed to trigger reprocessing")}finally{i.value=!1}}}async function F(_){if(k.value){i.value=!0;try{await z({input:{fileId:k.value.id,orgId:v.value[0]&&v.value[0].orgId||w.value.filter.orgId,canonicalSlot:_.value.canonicalSlot,confidence:_.value.confidence}}),u.add("success","File classified"),o.value=!1,M()}catch(I){u.add("error",I.message||"Failed to classify file")}finally{i.value=!1}}}async function s(){}function p(){const _=b.params.id;y.push({name:"MappingStudio",params:{id:_}})}async function E(_,I){const U=window.prompt("Rename file",_.name);if(U&&U!==_.name)try{await I(_.id,U),u.add("success","File renamed")}catch(Q){u.add("error",Q.message||"Rename failed")}}async function T(_,I){const U=window.prompt("Move file to path",_.path);if(U&&U!==_.path)try{await I(_.id,U),u.add("success","File moved")}catch(Q){u.add("error",Q.message||"Move failed")}}return{actionLoading:i,showClassify:o,canonicalSlots:d,triggerReprocess:V,submitClassification:F,triggerSync:s,openMappingStudio:p,promptRename:E,promptMove:T}}const wt={key:0,class:"text-medium-emphasis pa-4"},Ct={class:"px-4 pb-2"},bt={key:0,class:"pa-6 text-center"},It={key:1,class:"pa-4"},kt={class:"ml-2"},St={key:2,class:"pa-4"},Mt={class:"ml-2"},Dt=ae({__name:"FileExplorerView",setup(k){const{items:v,loading:w,variables:M,refetch:C,renameFile:z,moveFile:x,downloadFile:b,openInProvider:y}=De(),{state:u,folderTree:i,entityGroupIcon:o}=pt(),{filesByCanonical:d,filesByCanonicalList:V,filteredFiles:F,searchQuery:s}=gt(M,C),{getProviderColor:p,getProviderIcon:E,classificationColor:T,mimeIcon:_,fileFilters:I,classificationOptions:U,mimeOptions:Q}=me(),{triggerReprocessMutate:te,classifyMutate:N,triggerFullSync:Z}=yt(),{actionLoading:K,showClassify:Y,canonicalSlots:Re,triggerReprocess:ze,submitClassification:Te,triggerSync:Le,openMappingStudio:Ae}=Ft(u,v,M,C,te,N),h=O({get:()=>u.value.viewMode,set:g=>u.value.viewMode=g}),le=O({get:()=>u.value.fileViewMode,set:g=>u.value.fileViewMode=g}),fe=O({get:()=>u.value.selectedFolders,set:g=>u.value.selectedFolders=g}),ve=O({get:()=>u.value.openedFolders,set:g=>u.value.openedFolders=g}),ne=G(null),_e=O({get:()=>u.value.selectedFilters,set:g=>u.value.selectedFilters=g}),Be=O({get:()=>u.value.syncStatus,set:g=>u.value.syncStatus=g}),Oe=O({get:()=>u.value.showUploadDialog,set:g=>u.value.showUploadDialog=g}),se=O(()=>u.value.currentProvider),oe=O({get:()=>u.value.entityGroupBy,set:g=>u.value.entityGroupBy=g}),Pe=O(()=>{if(oe.value==="project"&&v.value){const g=[],l={};return v.value.forEach(S=>{var A;const $=((A=S.project)==null?void 0:A.id)||"unknown";l[$]||(l[$]=[]),l[$].push(S)}),Object.keys(l).forEach(S=>{var A;const $=(A=v.value.find(D=>{var j;return((j=D.project)==null?void 0:j.id)===S}))==null?void 0:A.project;g.push({key:S,label:($==null?void 0:$.name)||"Unknown Project",items:l[S]})}),g}else if(oe.value==="source"&&v.value){const g=[],l={};return v.value.forEach(S=>{var A;const $=((A=S.source)==null?void 0:A.id)||"unknown";l[$]||(l[$]=[]),l[$].push(S)}),Object.keys(l).forEach(S=>{var A;const $=(A=v.value.find(D=>{var j;return((j=D.source)==null?void 0:j.id)===S}))==null?void 0:A.source;g.push({key:S,label:($==null?void 0:$.name)||"Unknown Source",items:l[S]})}),g}return[]}),ge=G({canonicalSlot:"",confidence:.8});function Ne(g){if(Array.isArray(g)){const l=g.map(S=>typeof S=="string"?S:S.id);u.value.selectedFolders=l}else u.value.selectedFolders=[]}function je(g){ne.value=g}function Ge(g){}function We(g){}return ie(s,g=>{M.value.filter.name=g||void 0,M.value.filter.path=g||void 0,C()}),(g,l)=>{const S=a("v-col"),$=a("v-btn"),A=a("v-row"),D=a("v-icon"),j=a("v-tab"),ye=a("v-tabs"),Fe=a("v-spacer"),X=a("v-chip"),we=a("v-card-title"),Ce=a("v-text-field"),Qe=a("v-treeview"),be=a("v-card-text"),Ie=a("v-card"),Ye=a("v-btn-group"),de=a("v-list-item-title"),re=a("v-list-item"),ue=a("v-list"),qe=a("v-menu"),He=a("v-chip-group"),ke=a("v-expansion-panel-title"),Se=a("v-list-item-subtitle"),Me=a("v-expansion-panel-text"),xe=a("v-expansion-panel"),$e=a("v-expansion-panels");return f(),L("div",null,[t(A,{class:"mb-4"},{default:e(()=>[t(S,{cols:"12",md:"8"},{default:e(()=>l[13]||(l[13]=[P("h1",{class:"text-h4 font-weight-bold"}," File Explorer ",-1),P("p",{class:"text-subtitle-1 text-medium-emphasis"}," Browse and manage project files from connected storage ",-1)])),_:1,__:[13]}),t(S,{cols:"12",md:"4",class:"text-right"},{default:e(()=>[t($,{color:"primary","prepend-icon":"mdi-sync",loading:Be.value==="syncing",onClick:c(Le)},{default:e(()=>l[14]||(l[14]=[n(" Sync Now ",-1)])),_:1,__:[14]},8,["loading","onClick"]),t($,{class:"ml-2","prepend-icon":"mdi-upload",onClick:l[0]||(l[0]=r=>Oe.value=!0)},{default:e(()=>l[15]||(l[15]=[n(" Upload ",-1)])),_:1,__:[15]})]),_:1})]),_:1}),t(ye,{modelValue:h.value,"onUpdate:modelValue":l[1]||(l[1]=r=>h.value=r),class:"mb-4"},{default:e(()=>[t(j,{value:"source"},{default:e(()=>[t(D,{start:""},{default:e(()=>l[16]||(l[16]=[n(" mdi-folder-outline ",-1)])),_:1,__:[16]}),l[17]||(l[17]=n(" Source View ",-1))]),_:1,__:[17]}),t(j,{value:"canonical"},{default:e(()=>[t(D,{start:""},{default:e(()=>l[18]||(l[18]=[n(" mdi-folder-star ",-1)])),_:1,__:[18]}),l[19]||(l[19]=n(" Canonical View ",-1))]),_:1,__:[19]}),t(j,{value:"entity"},{default:e(()=>[t(D,{start:""},{default:e(()=>l[20]||(l[20]=[n(" mdi-sitemap ",-1)])),_:1,__:[20]}),l[21]||(l[21]=n(" Entity View ",-1))]),_:1,__:[21]})]),_:1},8,["modelValue"]),t(A,null,{default:e(()=>[t(S,{cols:"12",lg:"3"},{default:e(()=>[t(Ie,{class:"glass-card"},{default:e(()=>[t(we,{class:"d-flex align-center"},{default:e(()=>[t(D,{class:"mr-2"},{default:e(()=>l[22]||(l[22]=[n(" mdi-folder-multiple ",-1)])),_:1,__:[22]}),l[23]||(l[23]=n(" Folders ",-1)),t(Fe),t(X,{color:c(p)(se.value),size:"small",variant:"tonal"},{default:e(()=>[t(D,{start:"",size:"small"},{default:e(()=>[n(m(c(E)(se.value)),1)]),_:1}),n(" "+m(se.value),1)]),_:1},8,["color"])]),_:1,__:[23]}),t(be,{class:"pa-0"},{default:e(()=>[t(Ce,{modelValue:c(s),"onUpdate:modelValue":l[2]||(l[2]=r=>ce(s)?s.value=r:null),placeholder:"Search files...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",class:"ma-3"},null,8,["modelValue"]),c(i).length===0?(f(),L("div",wt," Folder tree integration is coming soon. ")):(f(),R(Qe,{key:1,selected:fe.value,"onUpdate:selected":[l[3]||(l[3]=r=>fe.value=r),Ne],opened:ve.value,"onUpdate:opened":l[4]||(l[4]=r=>ve.value=r),items:c(i),"item-key":"id","item-title":"name","item-children":"children",selectable:"","open-on-click":""},{prepend:e(({item:r})=>[t(D,{size:"small"},{default:e(()=>[n(m(r.type==="folder"?"mdi-folder":"mdi-file"),1)]),_:2},1024)]),_:1},8,["selected","opened","items"]))]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",lg:"6"},{default:e(()=>[t(Ie,{class:"glass-card"},{default:e(()=>[t(we,{class:"d-flex align-center"},{default:e(()=>[t(D,{class:"mr-2"},{default:e(()=>l[24]||(l[24]=[n(" mdi-file-multiple ",-1)])),_:1,__:[24]}),l[25]||(l[25]=n(" Files ",-1)),t(Fe),t(Ye,{density:"compact"},{default:e(()=>[t($,{variant:le.value==="table"?"flat":"text",icon:"mdi-view-list",onClick:l[5]||(l[5]=r=>le.value="table")},null,8,["variant"]),t($,{variant:le.value==="grid"?"flat":"text",icon:"mdi-view-grid",onClick:l[6]||(l[6]=r=>le.value="grid")},null,8,["variant"])]),_:1})]),_:1,__:[25]}),t(be,{class:"pa-0"},{default:e(()=>[h.value==="source"?(f(),L(W,{key:0},[P("div",Ct,[t(Ce,{modelValue:c(s),"onUpdate:modelValue":l[7]||(l[7]=r=>ce(s)?s.value=r:null),placeholder:"Search files...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",class:"mb-2"},null,8,["modelValue"]),t(He,{modelValue:_e.value,"onUpdate:modelValue":l[8]||(l[8]=r=>_e.value=r),multiple:""},{default:e(()=>[(f(!0),L(W,null,q(c(I),r=>(f(),R(X,{key:r.key,value:r.key,size:"small",variant:"outlined"},{default:e(()=>[t(D,{start:"",size:"small"},{default:e(()=>[n(m(r.icon),1)]),_:2},1024),n(" "+m(r.label),1)]),_:2},1032,["value"]))),128)),t(qe,null,{activator:e(({props:r})=>[t(X,Ee(r,{size:"small",variant:"outlined","prepend-icon":"mdi-filter"}),{default:e(()=>l[26]||(l[26]=[n(" Classification ",-1)])),_:2,__:[26]},1040)]),default:e(()=>[t(ue,null,{default:e(()=>[(f(!0),L(W,null,q(c(U),r=>(f(),R(re,{key:r.value,onClick:B=>(r.value,void 0)},{default:e(()=>[t(de,null,{default:e(()=>[n(m(r.label),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(nt,{"filtered-files":c(F),loading:c(w),"rename-file":c(z),"move-file":c(x),"download-file":c(b),"open-in-provider":c(y),onFileSelect:je},null,8,["filtered-files","loading","rename-file","move-file","download-file","open-in-provider"])],64)):h.value==="entity"?(f(),L(W,{key:1},[Object.keys(c(d).value).length===0?(f(),L("div",bt,[t(D,{size:"56",color:"primary",class:"mb-3"},{default:e(()=>l[27]||(l[27]=[n(" mdi-folder-star ",-1)])),_:1,__:[27]}),l[29]||(l[29]=P("div",{class:"text-h6 mb-2"}," No canonical groupings yet ",-1)),l[30]||(l[30]=P("div",{class:"text-body-2 text-medium-emphasis mb-4"}," Configure taxonomy rules and classifications in Mapping Studio to enable canonical slot grouping. ",-1)),t($,{color:"primary","prepend-icon":"mdi-map",onClick:c(Ae)},{default:e(()=>l[28]||(l[28]=[n(" Open Mapping Studio ",-1)])),_:1,__:[28]},8,["onClick"])])):(f(),L("div",It,[t($e,{variant:"accordion"},{default:e(()=>[(f(!0),L(W,null,q(c(V),r=>(f(),R(xe,{key:r.key},{default:e(()=>[t(ke,null,{default:e(()=>[t(D,{start:""},{default:e(()=>l[31]||(l[31]=[n(" mdi-folder-star ",-1)])),_:1,__:[31]}),P("span",kt,m(r.key||"Unassigned"),1),t(X,{class:"ml-3",size:"x-small",label:""},{default:e(()=>[n(m(r.items.length),1)]),_:2},1024)]),_:2},1024),t(Me,null,{default:e(()=>[t(ue,{density:"compact"},{default:e(()=>[(f(!0),L(W,null,q(r.items,B=>(f(),R(re,{key:B.id,onClick:Je=>ne.value=B},{prepend:e(()=>[t(D,{size:"small"},{default:e(()=>[n(m(c(_)(B.mimeType)),1)]),_:2},1024)]),append:e(()=>[t(X,{size:"x-small",color:c(T)(B.classificationStatus),variant:"tonal"},{default:e(()=>[n(m(B.classificationStatus),1)]),_:2},1032,["color"])]),default:e(()=>[t(de,null,{default:e(()=>[n(m(B.name),1)]),_:2},1024),t(Se,null,{default:e(()=>[n(m(B.path),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))],64)):h.value==="entity"?(f(),L("div",St,[t(ye,{modelValue:oe.value,"onUpdate:modelValue":l[9]||(l[9]=r=>oe.value=r),density:"compact",class:"mb-3"},{default:e(()=>[t(j,{value:"project"},{default:e(()=>[t(D,{start:""},{default:e(()=>l[32]||(l[32]=[n(" mdi-view-module ",-1)])),_:1,__:[32]}),l[33]||(l[33]=n("By Project ",-1))]),_:1,__:[33]}),t(j,{value:"source"},{default:e(()=>[t(D,{start:""},{default:e(()=>l[34]||(l[34]=[n(" mdi-cloud ",-1)])),_:1,__:[34]}),l[35]||(l[35]=n("By Source ",-1))]),_:1,__:[35]})]),_:1},8,["modelValue"]),t($e,null,{default:e(()=>[(f(!0),L(W,null,q(Pe.value,r=>(f(),R(xe,{key:r.key},{default:e(()=>[t(ke,null,{default:e(()=>[t(D,{start:""},{default:e(()=>[n(m(c(o)),1)]),_:1}),P("span",Mt,m(r.label),1),t(X,{class:"ml-3",size:"x-small",label:""},{default:e(()=>[n(m(r.items.length),1)]),_:2},1024)]),_:2},1024),t(Me,null,{default:e(()=>[t(ue,{density:"compact"},{default:e(()=>[(f(!0),L(W,null,q(r.items,B=>(f(),R(re,{key:B.id,onClick:Je=>ne.value=B},{prepend:e(()=>[t(D,{size:"small"},{default:e(()=>[n(m(c(_)(B.mimeType)),1)]),_:2},1024)]),default:e(()=>[t(de,null,{default:e(()=>[n(m(B.name),1)]),_:2},1024),t(Se,null,{default:e(()=>[n(m(B.path),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):J("",!0)]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",lg:"3"},{default:e(()=>[t(rt,{"selected-file":ne.value,"action-loading":c(K),"show-classify":c(Y),"classification-options":c(U),"mime-options":c(Q),onTriggerReprocess:c(ze),onShowClassify:l[10]||(l[10]=r=>Y.value=r),onApplyClassificationFilter:Ge,onApplyMimeFilter:We},null,8,["selected-file","action-loading","show-classify","classification-options","mime-options","onTriggerReprocess"])]),_:1})]),_:1}),t(ct,{modelValue:c(Y),"onUpdate:modelValue":l[11]||(l[11]=r=>ce(Y)?Y.value=r:null),form:ge.value,"canonical-slots":c(Re),"action-loading":c(K),onSubmitClassification:l[12]||(l[12]=r=>c(Te)(ge.value))},null,8,["modelValue","form","canonical-slots","action-loading"])])}}});export{Dt as default};
