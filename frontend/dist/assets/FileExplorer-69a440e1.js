import{_ as Fe}from"./supabase-cf010ec4.js";import{r as _,k as $e,v as ft,aj as pt,ab as vt,w as Ue,c as X,ac as I,A as l,a9 as t,a5 as d,a7 as u,E as k,_ as n,W as i,a8 as w,F as U,ad as D,B as Ee,ae as M,a3 as de,u as Ve}from"./vue-b3dbcb9b.js";import{b as _t,a as gt}from"./index-84246d85.js";import{g as A,u as yt,h as Z,j as It}from"./apollo-e4ecfb61.js";const kt=A`
  query Files($filter: FileFilter, $limit: Int, $offset: Int) {
    files(filter: $filter, limit: $limit, offset: $offset) {
      id
      orgId
      sourceId
      projectId
      path
      name
      size
      mimeType
      updatedAt
      metadata
      classificationStatus
      classificationConfidence
      canonicalSlot
      current
      deleted
      project { id name }
      source { id name provider }
    }
  }
`,bt=A`
  subscription OnFileUpdated($orgId: ID!) {
    fileUpdated(orgId: $orgId) {
      id
      orgId
      sourceId
      projectId
      path
      name
      size
      mimeType
      updatedAt
      metadata
      classificationStatus
      classificationConfidence
      canonicalSlot
      current
      deleted
    }
  }
`,wt=A`
  mutation RenameFile($orgId: ID!, $id: ID!, $name: String!) {
    renameFile(orgId: $orgId, id: $id, name: $name) {
      id
      name
      path
    }
  }
`,St=A`
  mutation MoveFile($orgId: ID!, $id: ID!, $path: String!) {
    moveFile(orgId: $orgId, id: $id, path: $path) {
      id
      name
      path
    }
  }
`;function xt(){var O;const h=_t(),L=_({filter:{orgId:((O=h.currentOrg)==null?void 0:O.id)||"",sourceId:void 0,classificationStatus:void 0,mimeType:void 0,path:void 0,name:void 0},limit:200,offset:0}),{result:ee,loading:x,refetch:E,onError:P}=yt(kt,L),b=_([]),{mutate:te}=Z(wt),{mutate:le}=Z(St);$e(()=>{var c;L.value.filter.orgId=((c=h.currentOrg)==null?void 0:c.id)||""}),$e(()=>{var c;(c=ee.value)!=null&&c.files&&(b.value=ee.value.files)});const{onResult:ae}=It(bt,()=>{var c;return{orgId:((c=h.currentOrg)==null?void 0:c.id)||""}});ae(c=>{var S;const p=(S=c.data)==null?void 0:S.fileUpdated;if(!p)return;const F=b.value.findIndex(j=>j.id===p.id);F>=0?b.value[F]={...b.value[F],...p}:b.value.unshift(p)});async function r(c,p){await te({orgId:L.value.filter.orgId,id:c,name:p}),await E()}async function N(c,p){await le({orgId:L.value.filter.orgId,id:c,path:p}),await E()}function z(c){var F;const p=(F=c==null?void 0:c.metadata)==null?void 0:F.downloadUrl;p&&window.open(p,"_blank")}function ue(c){var F,S;const p=((F=c==null?void 0:c.metadata)==null?void 0:F.providerUrl)||((S=c==null?void 0:c.metadata)==null?void 0:S.previewUrl);p&&window.open(p,"_blank")}return{items:b,loading:x,refetch:E,onError:P,variables:L,renameFile:r,moveFile:N,downloadFile:z,openInProvider:ue}}const Ct={key:0,class:"text-medium-emphasis pa-4"},Ft={class:"px-4 pb-2"},$t={class:"d-flex align-center"},Ut={class:"d-flex align-center"},Et={key:0,class:"pa-6 text-center"},Vt={key:1,class:"pa-4"},Mt={class:"ml-2"},zt={key:2,class:"pa-4"},Tt={class:"ml-2"},Dt={class:"text-subtitle-2 mb-2"},At={key:0,class:"ml-2 text-medium-emphasis"},Lt={class:"mt-4 d-flex gap-2"},Rt={class:"text-left"},Bt=ft({__name:"FileExplorer",setup(h){const L=pt(),ee=vt(),x=gt(),E=_("source"),P=_("table"),b=_(""),te=_([]),le=_(["root"]),ae=_([]),r=_(null),N=_([]),z=_("idle"),ue=_(!1),O=_("Unknown"),c=_([]),{items:p,loading:F,variables:S,refetch:j,renameFile:Me,moveFile:ze,downloadFile:Te,openInProvider:De}=xt();Ue(b,o=>{S.value.filter.name=o||void 0,S.value.filter.path=o||void 0,j()});const ce=X(()=>{const o={};return p.value.forEach(e=>{const s=e.canonicalSlot||"Unassigned";o[s]=o[s]||[],o[s].push(e)}),o}),Ae=X(()=>{const o=[],e=ce.value;return Object.keys(e).forEach(s=>o.push({key:s,items:e[s]})),o}),Le=X(()=>{let o=p.value;if(b.value){const e=b.value.toLowerCase();o=o.filter(s=>s.name.toLowerCase().includes(e)||s.path.toLowerCase().includes(e))}return N.value.length>0&&(o=o.filter(e=>N.value.some(s=>{switch(s){case"current":return e.current===!0;case"deleted":return e.deleted===!0;default:return!0}}))),o}),ne=_("project"),Re=X(()=>ne.value==="project"?"mdi-view-module":"mdi-cloud"),Pe=X(()=>{var v,Q,Y,f;const o={},e=p.value,s=ne.value;for(const C of e){const R=s==="project"?((v=C.project)==null?void 0:v.id)||"Unassigned":((Q=C.source)==null?void 0:Q.id)||"Unassigned",J=s==="project"?((Y=C.project)==null?void 0:Y.name)||"Unassigned Project":((f=C.source)==null?void 0:f.name)||"Unassigned Source";o[R]||(o[R]={key:R,label:J,items:[]}),o[R].items.push(C)}return Object.values(o)}),Ne=[{title:"Name",key:"name",sortable:!0},{title:"MIME",key:"mimeType",sortable:!0},{title:"Size",key:"size",sortable:!0},{title:"Updated",key:"updatedAt",sortable:!0},{title:"",key:"actions",sortable:!1}],Oe=[{key:"current",label:"Current",icon:"mdi-check-circle"},{key:"deleted",label:"Deleted",icon:"mdi-delete"}],me=[{value:"PENDING",label:"Pending"},{value:"CLASSIFIED",label:"Classified"},{value:"MANUAL_REVIEW",label:"Manual review"},{value:"FAILED",label:"Failed"}];function fe(o){S.value.filter.classificationStatus=o,j()}const je=[{value:"application/pdf",label:"PDF"},{value:"image/jpeg",label:"JPEG"},{value:"image/png",label:"PNG"},{value:"text/plain",label:"Text"},{value:"application/json",label:"JSON"}];function Be(o){S.value.filter.mimeType=o,j()}function Ge(o){switch(o.toLowerCase()){case"dropbox":return"blue";case"googledrive":return"green";default:return"grey"}}function qe(o){switch(o.toLowerCase()){case"dropbox":return"mdi-dropbox";case"googledrive":return"mdi-google-drive";default:return"mdi-cloud"}}function pe(o){const e=["Bytes","KB","MB","GB"];if(o===0)return"0 Bytes";const s=Math.floor(Math.log(o)/Math.log(1024));return Math.round(o/Math.pow(1024,s)*100)/100+" "+e[s]}function ve(o){return new Date(o).toLocaleDateString()}function re(o){switch((o||"").toUpperCase()){case"CLASSIFIED":return"green";case"MANUAL_REVIEW":return"orange";case"FAILED":return"red";default:return"grey"}}function oe(o){return o?o.startsWith("image/")?"mdi-file-image":o.startsWith("video/")?"mdi-file-video":o.startsWith("audio/")?"mdi-file-music":o==="application/pdf"?"mdi-file-pdf-box":o.startsWith("text/")?"mdi-file-document":"mdi-file":"mdi-file"}function We(o){console.log("Selected folders:",o)}function Qe(o,{item:e}){r.value=e}function Ye(){const o=L.params.id;ee.push({name:"MappingStudio",params:{id:o}})}async function Je(o){const e=window.prompt("Rename file",o.name);if(e&&e!==o.name)try{await Me(o.id,e),x.add("success","File renamed")}catch(s){x.add("error",s.message||"Rename failed")}}async function He(o){const e=window.prompt("Move file to path",o.path);if(e&&e!==o.path)try{await ze(o.id,e),x.add("success","File moved")}catch(s){x.add("error",s.message||"Move failed")}}const B=_(!1),W=_(!1),Ke=A`
  mutation TriggerFileReprocessing($fileId: ID!, $orgId: ID!) {
    triggerFileReprocessing(fileId: $fileId, orgId: $orgId)
  }
`,Xe=A`
  mutation ClassifyFile($input: ClassifyFileInput!) {
    classifyFile(input: $input) {
      id
      classificationStatus
      classificationConfidence
      canonicalSlot
      updatedAt
    }
  }
`,{mutate:Ze}=Z(Ke),{mutate:he}=Z(Xe);async function et(){if(r.value){B.value=!0;try{await Ze({fileId:r.value.id,orgId:p.value[0]&&p.value[0].orgId||""}),x.add("success","Reprocessing triggered")}catch(o){x.add("error",o.message||"Failed to trigger reprocessing")}finally{B.value=!1}}}const tt=A`
  query CanonicalSlots($orgId: ID!) {
    canonicalSlots(orgId: $orgId) { key }
  }
`,_e=_([]);Ue(()=>S.value.filter.orgId,async o=>{if(o)try{const s=(await(await Fe(()=>import("./apollo-e4ecfb61.js").then(v=>v.k),["assets/apollo-e4ecfb61.js","assets/vue-b3dbcb9b.js"])).ApolloClient.prototype.query.call((await Fe(()=>import("./index-84246d85.js").then(v=>v.d),["assets/index-84246d85.js","assets/vue-b3dbcb9b.js","assets/apollo-e4ecfb61.js","assets/supabase-cf010ec4.js","assets/index-a045e099.css"])).apolloClient,{query:tt,variables:{orgId:o}})).data;_e.value=(s==null?void 0:s.canonicalSlots)||[]}catch{}},{immediate:!0});const G=_({canonicalSlot:"",confidence:.9});async function lt(){if(r.value){B.value=!0;try{await he({input:{fileId:r.value.id,orgId:p.value[0]&&p.value[0].orgId||S.value.filter.orgId,canonicalSlot:G.value.canonicalSlot,confidence:G.value.confidence}}),x.add("success","File classified"),W.value=!1,j()}catch(o){x.add("error",o.message||"Failed to classify file")}finally{B.value=!1}}}const at=A`
  mutation TriggerFullSync($orgId: ID!) { triggerFullSync(orgId: $orgId) }
`,{mutate:nt}=Z(at);async function ot(){z.value="syncing";try{await nt({orgId:S.value.filter.orgId}),x.add("success","Sync triggered")}catch(o){x.add("error",o.message||"Sync failed"),z.value="error";return}setTimeout(()=>{z.value="idle"},1500)}return(o,e)=>{const s=d("v-col"),v=d("v-btn"),Q=d("v-btn-group"),Y=d("v-row"),f=d("v-icon"),C=d("v-tab"),R=d("v-tabs"),J=d("v-spacer"),$=d("v-chip"),ie=d("v-card-title"),ge=d("v-text-field"),it=d("v-treeview"),se=d("v-card-text"),H=d("v-card"),g=d("v-list-item-title"),y=d("v-list-item"),q=d("v-list"),ye=d("v-menu"),st=d("v-chip-group"),dt=d("v-data-table"),Ie=d("v-expansion-panel-title"),V=d("v-list-item-subtitle"),ke=d("v-expansion-panel-text"),be=d("v-expansion-panel"),we=d("v-expansion-panels"),Se=d("v-divider"),xe=d("v-list-subheader"),ut=d("v-select"),rt=d("v-slider"),ct=d("v-card-actions"),mt=d("v-dialog");return u(),I("div",null,[l(Y,{class:"mb-4"},{default:t(()=>[l(s,{cols:"12",md:"8"},{default:t(()=>e[16]||(e[16]=[k("h1",{class:"text-h4 font-weight-bold"}," File Explorer ",-1),k("p",{class:"text-subtitle-1 text-medium-emphasis"}," Browse and manage project files from connected storage ",-1)])),_:1,__:[16]}),l(s,{cols:"12",md:"4",class:"text-right"},{default:t(()=>[l(Q,{density:"compact"},{default:t(()=>[l(v,{color:z.value==="syncing"?"warning":"primary",loading:z.value==="syncing","prepend-icon":"mdi-sync",class:"liquid-button",onClick:ot},{default:t(()=>[n(i(z.value==="syncing"?"Syncing...":"Sync Now"),1)]),_:1},8,["color","loading"]),l(v,{"prepend-icon":"mdi-upload",class:"liquid-button",onClick:e[0]||(e[0]=a=>ue.value=!0)},{default:t(()=>e[17]||(e[17]=[n(" Upload ",-1)])),_:1,__:[17]})]),_:1})]),_:1})]),_:1}),l(R,{modelValue:E.value,"onUpdate:modelValue":e[1]||(e[1]=a=>E.value=a),class:"mb-4"},{default:t(()=>[l(C,{value:"source"},{default:t(()=>[l(f,{start:""},{default:t(()=>e[18]||(e[18]=[n(" mdi-folder-outline ",-1)])),_:1,__:[18]}),e[19]||(e[19]=n(" Source View ",-1))]),_:1,__:[19]}),l(C,{value:"canonical"},{default:t(()=>[l(f,{start:""},{default:t(()=>e[20]||(e[20]=[n(" mdi-folder-star ",-1)])),_:1,__:[20]}),e[21]||(e[21]=n(" Canonical View ",-1))]),_:1,__:[21]}),l(C,{value:"entity"},{default:t(()=>[l(f,{start:""},{default:t(()=>e[22]||(e[22]=[n(" mdi-sitemap ",-1)])),_:1,__:[22]}),e[23]||(e[23]=n(" Entity View ",-1))]),_:1,__:[23]})]),_:1},8,["modelValue"]),l(Y,null,{default:t(()=>[l(s,{cols:"12",lg:"3"},{default:t(()=>[l(H,{class:"glass-card"},{default:t(()=>[l(ie,{class:"d-flex align-center"},{default:t(()=>[l(f,{class:"mr-2"},{default:t(()=>e[24]||(e[24]=[n(" mdi-folder-multiple ",-1)])),_:1,__:[24]}),e[25]||(e[25]=n(" Folders ",-1)),l(J),l($,{color:Ge(O.value),size:"small",variant:"tonal"},{default:t(()=>[l(f,{start:"",size:"small"},{default:t(()=>[n(i(qe(O.value)),1)]),_:1}),n(" "+i(O.value),1)]),_:1},8,["color"])]),_:1,__:[25]}),l(se,{class:"pa-0"},{default:t(()=>[l(ge,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=a=>b.value=a),placeholder:"Search files...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",class:"ma-3"},null,8,["modelValue"]),c.value.length===0?(u(),I("div",Ct," Folder tree integration is coming soon. ")):(u(),w(it,{key:1,selected:te.value,"onUpdate:selected":[e[3]||(e[3]=a=>te.value=a),We],opened:le.value,"onUpdate:opened":e[4]||(e[4]=a=>le.value=a),items:c.value,"item-key":"id","item-title":"name","item-children":"children",selectable:"","open-on-click":""},{prepend:t(({item:a})=>[l(f,{size:"small"},{default:t(()=>[n(i(a.type==="folder"?"mdi-folder":"mdi-file"),1)]),_:2},1024)]),_:1},8,["selected","opened","items"]))]),_:1})]),_:1})]),_:1}),l(s,{cols:"12",lg:"6"},{default:t(()=>[l(H,{class:"glass-card"},{default:t(()=>[l(ie,{class:"d-flex align-center"},{default:t(()=>[l(f,{class:"mr-2"},{default:t(()=>e[26]||(e[26]=[n(" mdi-file-multiple ",-1)])),_:1,__:[26]}),e[27]||(e[27]=n(" Files ",-1)),l(J),l(Q,{density:"compact"},{default:t(()=>[l(v,{variant:P.value==="table"?"flat":"text",icon:"mdi-view-list",onClick:e[5]||(e[5]=a=>P.value="table")},null,8,["variant"]),l(v,{variant:P.value==="grid"?"flat":"text",icon:"mdi-view-grid",onClick:e[6]||(e[6]=a=>P.value="grid")},null,8,["variant"])]),_:1})]),_:1,__:[27]}),l(se,{class:"pa-0"},{default:t(()=>[E.value==="source"?(u(),I(U,{key:0},[k("div",Ft,[l(ge,{modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=a=>b.value=a),placeholder:"Search files...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",class:"mb-2"},null,8,["modelValue"]),l(st,{modelValue:N.value,"onUpdate:modelValue":e[8]||(e[8]=a=>N.value=a),multiple:""},{default:t(()=>[(u(),I(U,null,D(Oe,a=>l($,{key:a.key,value:a.key,size:"small",variant:"outlined"},{default:t(()=>[l(f,{start:"",size:"small"},{default:t(()=>[n(i(a.icon),1)]),_:2},1024),n(" "+i(a.label),1)]),_:2},1032,["value"])),64)),l(ye,null,{activator:t(({props:a})=>[l($,Ee(a,{size:"small",variant:"outlined","prepend-icon":"mdi-filter"}),{default:t(()=>e[28]||(e[28]=[n(" Classification ",-1)])),_:2,__:[28]},1040)]),default:t(()=>[l(q,null,{default:t(()=>[(u(),I(U,null,D(me,a=>l(y,{key:a.value,onClick:m=>fe(a.value)},{default:t(()=>[l(g,null,{default:t(()=>[n(i(a.label),1)]),_:2},1024)]),_:2},1032,["onClick"])),64))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l(dt,{selected:ae.value,"onUpdate:selected":e[9]||(e[9]=a=>ae.value=a),items:Le.value,headers:Ne,"item-key":"id","show-select":"","onClick:row":Qe},{"item.name":t(({item:a})=>{var m,T,K,Ce;return[k("div",$t,[l(f,{class:"mr-2",size:"small"},{default:t(()=>e[29]||(e[29]=[n(" mdi-file ",-1)])),_:1,__:[29]}),k("span",null,i(a.name),1),a.classificationStatus&&a.classificationStatus!=="PENDING"?(u(),w($,{key:0,class:"ml-2",color:re(a.classificationStatus),size:"x-small",label:"",variant:"tonal"},{default:t(()=>[n(i(a.classificationStatus),1)]),_:2},1032,["color"])):M("",!0),(T=(m=a.metadata)==null?void 0:m.policyViolations)!=null&&T.length?(u(),w($,{key:1,class:"ml-1",color:"red",size:"x-small",label:"",variant:"tonal"},{default:t(()=>[n(i(a.metadata.policyViolations.length)+" PV ",1)]),_:2},1024)):M("",!0),(Ce=(K=a.metadata)==null?void 0:K.suggestions)!=null&&Ce.length?(u(),w($,{key:2,class:"ml-1",color:"blue",size:"x-small",label:"",variant:"tonal"},{default:t(()=>[n(i(a.metadata.suggestions.length)+" SG ",1)]),_:2},1024)):M("",!0)])]}),"item.size":t(({item:a})=>[n(i(pe(a.size||0)),1)]),"item.updatedAt":t(({item:a})=>[n(i(ve(a.updatedAt)),1)]),"item.mimeType":t(({item:a})=>[k("div",Ut,[l(f,{class:"mr-1",size:"x-small"},{default:t(()=>[n(i(oe(a.mimeType)),1)]),_:2},1024),k("span",null,i(a.mimeType),1)])]),"item.actions":t(({item:a})=>[l(ye,null,{activator:t(({props:m})=>[l(v,Ee({icon:"mdi-dots-vertical"},m,{variant:"text"}),null,16)]),default:t(()=>[l(q,null,{default:t(()=>[l(y,{onClick:de(m=>Je(a),["stop"])},{default:t(()=>[l(g,null,{default:t(()=>e[30]||(e[30]=[n("Rename",-1)])),_:1,__:[30]})]),_:2},1032,["onClick"]),l(y,{onClick:de(m=>He(a),["stop"])},{default:t(()=>[l(g,null,{default:t(()=>e[31]||(e[31]=[n("Move",-1)])),_:1,__:[31]})]),_:2},1032,["onClick"]),l(y,{onClick:de(m=>Ve(Te)(a),["stop"])},{default:t(()=>[l(g,null,{default:t(()=>e[32]||(e[32]=[n("Download",-1)])),_:1,__:[32]})]),_:2},1032,["onClick"]),l(y,{onClick:de(m=>Ve(De)(a),["stop"])},{default:t(()=>[l(g,null,{default:t(()=>e[33]||(e[33]=[n("Open in Provider",-1)])),_:1,__:[33]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["selected","items"])],64)):E.value==="canonical"?(u(),I(U,{key:1},[Object.keys(ce.value.value).length===0?(u(),I("div",Et,[l(f,{size:"56",color:"primary",class:"mb-3"},{default:t(()=>e[34]||(e[34]=[n(" mdi-folder-star ",-1)])),_:1,__:[34]}),e[36]||(e[36]=k("div",{class:"text-h6 mb-2"}," No canonical groupings yet ",-1)),e[37]||(e[37]=k("div",{class:"text-body-2 text-medium-emphasis mb-4"}," Configure taxonomy rules and classifications in Mapping Studio to enable canonical slot grouping. ",-1)),l(v,{color:"primary","prepend-icon":"mdi-map",onClick:Ye},{default:t(()=>e[35]||(e[35]=[n(" Open Mapping Studio ",-1)])),_:1,__:[35]})])):(u(),I("div",Vt,[l(we,{variant:"accordion"},{default:t(()=>[(u(!0),I(U,null,D(Ae.value,a=>(u(),w(be,{key:a.key},{default:t(()=>[l(Ie,null,{default:t(()=>[l(f,{start:""},{default:t(()=>e[38]||(e[38]=[n(" mdi-folder-star ",-1)])),_:1,__:[38]}),k("span",Mt,i(a.key||"Unassigned"),1),l($,{class:"ml-3",size:"x-small",label:""},{default:t(()=>[n(i(a.items.length),1)]),_:2},1024)]),_:2},1024),l(ke,null,{default:t(()=>[l(q,{density:"compact"},{default:t(()=>[(u(!0),I(U,null,D(a.items,m=>(u(),w(y,{key:m.id,onClick:T=>r.value=m},{prepend:t(()=>[l(f,{size:"small"},{default:t(()=>[n(i(oe(m.mimeType)),1)]),_:2},1024)]),append:t(()=>[l($,{size:"x-small",color:re(m.classificationStatus),variant:"tonal"},{default:t(()=>[n(i(m.classificationStatus),1)]),_:2},1032,["color"])]),default:t(()=>[l(g,null,{default:t(()=>[n(i(m.name),1)]),_:2},1024),l(V,null,{default:t(()=>[n(i(m.path),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))],64)):E.value==="entity"?(u(),I("div",zt,[l(R,{modelValue:ne.value,"onUpdate:modelValue":e[10]||(e[10]=a=>ne.value=a),density:"compact",class:"mb-3"},{default:t(()=>[l(C,{value:"project"},{default:t(()=>[l(f,{start:""},{default:t(()=>e[39]||(e[39]=[n(" mdi-view-module ",-1)])),_:1,__:[39]}),e[40]||(e[40]=n("By Project ",-1))]),_:1,__:[40]}),l(C,{value:"source"},{default:t(()=>[l(f,{start:""},{default:t(()=>e[41]||(e[41]=[n(" mdi-cloud ",-1)])),_:1,__:[41]}),e[42]||(e[42]=n("By Source ",-1))]),_:1,__:[42]})]),_:1},8,["modelValue"]),l(we,null,{default:t(()=>[(u(!0),I(U,null,D(Pe.value,a=>(u(),w(be,{key:a.key},{default:t(()=>[l(Ie,null,{default:t(()=>[l(f,{start:""},{default:t(()=>[n(i(Re.value),1)]),_:1}),k("span",Tt,i(a.label),1),l($,{class:"ml-3",size:"x-small",label:""},{default:t(()=>[n(i(a.items.length),1)]),_:2},1024)]),_:2},1024),l(ke,null,{default:t(()=>[l(q,{density:"compact"},{default:t(()=>[(u(!0),I(U,null,D(a.items,m=>(u(),w(y,{key:m.id,onClick:T=>r.value=m},{prepend:t(()=>[l(f,{size:"small"},{default:t(()=>[n(i(oe(m.mimeType)),1)]),_:2},1024)]),default:t(()=>[l(g,null,{default:t(()=>[n(i(m.name),1)]),_:2},1024),l(V,null,{default:t(()=>[n(i(m.path),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):M("",!0)]),_:1})]),_:1})]),_:1}),l(s,{cols:"12",lg:"3"},{default:t(()=>[r.value?(u(),w(H,{key:0,class:"glass-card"},{default:t(()=>[l(ie,null,{default:t(()=>[l(f,{class:"mr-2"},{default:t(()=>e[43]||(e[43]=[n(" mdi-information ",-1)])),_:1,__:[43]}),e[44]||(e[44]=n(" Inspector ",-1))]),_:1,__:[44]}),l(se,null,{default:t(()=>{var a,m;return[k("h4",Dt,i(r.value.name),1),l(q,{density:"compact"},{default:t(()=>{var T;return[l(y,null,{default:t(()=>[l(g,null,{default:t(()=>e[45]||(e[45]=[n("Size",-1)])),_:1,__:[45]}),l(V,null,{default:t(()=>[n(i(pe(r.value.size||0)),1)]),_:1})]),_:1}),l(y,null,{default:t(()=>[l(g,null,{default:t(()=>e[46]||(e[46]=[n("Updated",-1)])),_:1,__:[46]}),l(V,null,{default:t(()=>[n(i(ve(r.value.updatedAt||"")),1)]),_:1})]),_:1}),l(y,null,{default:t(()=>[l(g,null,{default:t(()=>e[47]||(e[47]=[n("Path",-1)])),_:1,__:[47]}),l(V,{class:"text-wrap"},{default:t(()=>[n(i(r.value.path),1)]),_:1})]),_:1}),l(y,null,{default:t(()=>[l(g,null,{default:t(()=>e[48]||(e[48]=[n("MIME",-1)])),_:1,__:[48]}),l(V,{class:"text-wrap"},{default:t(()=>[n(i(r.value.mimeType),1)]),_:1})]),_:1}),(T=r.value.metadata)!=null&&T.preview||r.value.extractedText?(u(),w(y,{key:0},{default:t(()=>[l(g,null,{default:t(()=>e[49]||(e[49]=[n("Preview",-1)])),_:1,__:[49]}),l(V,{class:"text-wrap",style:{"white-space":"pre-wrap","max-height":"240px",overflow:"auto"}},{default:t(()=>{var K;return[n(i(((K=r.value.metadata)==null?void 0:K.preview)||r.value.extractedText),1)]}),_:1})]),_:1})):M("",!0),l(y,null,{default:t(()=>[l(g,null,{default:t(()=>e[50]||(e[50]=[n("Classification",-1)])),_:1,__:[50]}),l(V,null,{default:t(()=>[l($,{color:re(r.value.classificationStatus),size:"small",label:"",variant:"tonal"},{default:t(()=>[n(i(r.value.classificationStatus),1)]),_:1},8,["color"]),r.value.classificationConfidence?(u(),I("span",At,i((r.value.classificationConfidence*100).toFixed(0))+"% ",1)):M("",!0)]),_:1})]),_:1}),r.value.canonicalSlot?(u(),w(y,{key:1},{default:t(()=>[l(g,null,{default:t(()=>e[51]||(e[51]=[n("Canonical Slot",-1)])),_:1,__:[51]}),l(V,null,{default:t(()=>[n(i(r.value.canonicalSlot),1)]),_:1})]),_:1})):M("",!0)]}),_:1}),k("div",Lt,[l(v,{color:"primary","prepend-icon":"mdi-refresh",loading:B.value,onClick:et},{default:t(()=>e[52]||(e[52]=[n(" Reprocess ",-1)])),_:1,__:[52]},8,["loading"]),l(v,{color:"secondary","prepend-icon":"mdi-tag",onClick:e[11]||(e[11]=T=>W.value=!0)},{default:t(()=>e[53]||(e[53]=[n(" Classify ",-1)])),_:1,__:[53]}),(a=r.value.metadata)!=null&&a.downloadUrl?(u(),w(v,{key:0,href:r.value.metadata.downloadUrl,target:"_blank","prepend-icon":"mdi-download"},{default:t(()=>e[54]||(e[54]=[n(" Download ",-1)])),_:1,__:[54]},8,["href"])):M("",!0),(m=r.value.metadata)!=null&&m.previewUrl?(u(),w(v,{key:1,href:r.value.metadata.previewUrl,target:"_blank","prepend-icon":"mdi-open-in-new"},{default:t(()=>e[55]||(e[55]=[n(" Open Preview ",-1)])),_:1,__:[55]},8,["href"])):M("",!0)])]}),_:1})]),_:1})):(u(),w(H,{key:1,class:"text-center pa-8 glass-card"},{default:t(()=>[l(f,{size:"48",color:"grey-lighten-1"},{default:t(()=>e[56]||(e[56]=[n(" mdi-cursor-default-click ",-1)])),_:1,__:[56]}),e[61]||(e[61]=k("p",{class:"text-medium-emphasis mt-2"}," Select a file to view details ",-1)),l(Se,{class:"my-4"}),k("div",Rt,[e[60]||(e[60]=k("div",{class:"text-subtitle-2 mb-2"}," Facets ",-1)),l(q,{density:"compact"},{default:t(()=>[l(xe,null,{default:t(()=>e[57]||(e[57]=[n("Classification",-1)])),_:1,__:[57]}),(u(),I(U,null,D(me,a=>l(y,{key:a.value,onClick:m=>fe(a.value)},{prepend:t(()=>[l(f,{size:"x-small"},{default:t(()=>e[58]||(e[58]=[n(" mdi-tag ",-1)])),_:1,__:[58]})]),default:t(()=>[l(g,null,{default:t(()=>[n(i(a.label),1)]),_:2},1024)]),_:2},1032,["onClick"])),64)),l(Se,{class:"my-2"}),l(xe,null,{default:t(()=>e[59]||(e[59]=[n("MIME Type",-1)])),_:1,__:[59]}),(u(),I(U,null,D(je,a=>l(y,{key:a.value,onClick:m=>Be(a.value)},{prepend:t(()=>[l(f,{size:"x-small"},{default:t(()=>[n(i(oe(a.value)),1)]),_:2},1024)]),default:t(()=>[l(g,null,{default:t(()=>[n(i(a.label),1)]),_:2},1024)]),_:2},1032,["onClick"])),64))]),_:1})])]),_:1,__:[61]}))]),_:1})]),_:1}),l(mt,{modelValue:W.value,"onUpdate:modelValue":e[15]||(e[15]=a=>W.value=a),"max-width":"500"},{default:t(()=>[l(H,{class:"glass-card"},{default:t(()=>[l(ie,null,{default:t(()=>[l(f,{class:"mr-2"},{default:t(()=>e[62]||(e[62]=[n(" mdi-tag ",-1)])),_:1,__:[62]}),e[63]||(e[63]=n(" Classify File ",-1))]),_:1,__:[63]}),l(se,null,{default:t(()=>[l(ut,{modelValue:G.value.canonicalSlot,"onUpdate:modelValue":e[12]||(e[12]=a=>G.value.canonicalSlot=a),items:_e.value,"item-title":"key","item-value":"key",label:"Canonical Slot"},null,8,["modelValue","items"]),l(rt,{modelValue:G.value.confidence,"onUpdate:modelValue":e[13]||(e[13]=a=>G.value.confidence=a),min:"0",max:"1",step:"0.01",label:"Confidence",class:"mt-4"},null,8,["modelValue"])]),_:1}),l(ct,null,{default:t(()=>[l(J),l(v,{variant:"text",onClick:e[14]||(e[14]=a=>W.value=!1)},{default:t(()=>e[64]||(e[64]=[n(" Cancel ",-1)])),_:1,__:[64]}),l(v,{color:"primary",loading:B.value,onClick:lt},{default:t(()=>e[65]||(e[65]=[n(" Save ",-1)])),_:1,__:[65]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Bt as default};
