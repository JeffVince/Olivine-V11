import{r as f,c as h,v as z,a8 as p,a9 as o,a5 as l,a7 as _,A as a,E as m,_ as c,u as d,W as g,ac as R,ae as A,D as X,ad as j,F as q,w as T,a as P}from"./vue-b3dbcb9b.js";import{g as H,u as ne,h as Z}from"./apollo-e4ecfb61.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const E=f(!1),W=f(!1),x=f(!1),V=f(null),M=f(null),Q=f([]),N=f([]),K=f(""),D=f(!1),B=f({type:"",name:"",config:{enableWebhooks:!1}}),ae=h({get:()=>{var t;return((t=V.value)==null?void 0:t.rootFolder)||""},set:t=>{V.value&&(V.value.rootFolder=t)}}),le=h({get:()=>{var t,r;return((r=(t=V.value)==null?void 0:t.config)==null?void 0:r.enableWebhooks)||!1},set:t=>{V.value&&(V.value.config||(V.value.config={}),V.value.config.enableWebhooks=t)}}),Y=f([{id:"dropbox",type:"dropbox",name:"Dropbox",description:"Connect your Dropbox account to sync files",icon:"mdi-dropbox",color:"#0061ff"},{id:"googledrive",type:"googledrive",name:"Google Drive",description:"Connect your Google Drive account to sync files",icon:"mdi-google-drive",color:"#4285f4"},{id:"onedrive",type:"onedrive",name:"OneDrive",description:"Connect your OneDrive account to sync files",icon:"mdi-microsoft-onedrive",color:"#0078d4"}]),se=h(()=>{if(!K.value)return N.value;const t=K.value.toLowerCase();return N.value.filter(r=>r.name.toLowerCase().includes(t)||r.description.toLowerCase().includes(t)||r.type.toLowerCase().includes(t))}),ie=H`
  query GetSources($organizationId: ID!) {
    getSources(organizationId: $organizationId) {
      id
      type
      name
      description
      active
      updatedAt
      config {
        rootFolder
        enableWebhooks
      }
    }
  }
`,re=H`
  mutation CreateSource($input: CreateSourceInput!) {
    createSource(input: $input) {
      id
      type
      name
      description
      active
      updatedAt
      config {
        rootFolder
        enableWebhooks
      }
    }
  }
`,de=H`
  mutation TriggerSync($input: TriggerSyncInput!) {
    triggerSync(input: $input) {
      success
      message
    }
  }
`;ne(ie,()=>({organizationId:"12345"}),()=>({enabled:!0,fetchPolicy:"cache-and-network"}));Z(re);Z(de);function ce(t){const r=Y.value.find(e=>e.type===t);return r?r.color:"#666"}function ue(t){const r=Y.value.find(e=>e.type===t);return r?r.icon:"mdi-help"}function _e(t){switch(t){case"error":return"error";case"warn":return"warning";case"warning":return"warning";case"success":return"success";case"info":return"info";default:return"default"}}function ve(t){return new Date(t).toLocaleDateString()}function me(t){return new Date(t).toLocaleString()}function ee(t,r){console.log(`[${t.toUpperCase()}] ${r}`)}function O(t){ee("error",t)}function J(t){ee("success",t)}const G="http://localhost:8080/api";async function te(t){try{if(D.value=!0,t.__existing){window.location.href=`${G}/auth/${t.type}?organizationId=12345`;return}window.location.href=`${G}/auth/${t.type}?organizationId=12345`}catch(r){O(`Failed to connect ${t.name}: ${r}`)}finally{D.value=!1}}async function pe(t){try{if(D.value=!0,!(await fetch(`${G}/sources/${t.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to disconnect integration");N.value=N.value.filter(e=>e.id!==t.id),J(`${t.name} disconnected successfully`)}catch(r){O(`Failed to disconnect ${t.name}: ${r}`)}finally{D.value=!1}}async function ge(t){try{if(D.value=!0,!(await fetch(`${G}/sources/${t.id}/sync`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to trigger sync");J(`Sync started for ${t.name}`);const e=N.value.find(n=>n.id===t.id);e&&(e.lastSync=new Date().toISOString())}catch(r){O(`Failed to trigger sync for ${t.name}: ${r}`)}finally{D.value=!1}}function fe(t){V.value=t,W.value=!0}async function ye(t){try{M.value=t,D.value=!0;const r=await fetch(`${G}/sources/${t.id}/logs`);if(!r.ok)throw new Error("Failed to fetch logs");const e=await r.json();Q.value=e.map(n=>({id:n.id,timestamp:n.timestamp,level:n.level,message:n.message})),x.value=!0}catch(r){O(`Failed to fetch logs for ${t.name}: ${r}`)}finally{D.value=!1}}function be(t){B.value={type:t.type,name:`${t.name} Integration`,config:{}},E.value=!0}function we(){E.value=!1,B.value.type&&te({id:"",type:B.value.type,name:B.value.name,description:"",connected:!1})}async function Ie(){try{D.value=!0,J("Configuration saved successfully"),oe()}catch(t){O(`Failed to save configuration: ${t}`)}finally{D.value=!1}}function oe(){W.value=!1,V.value=null}function $e(){x.value=!1,M.value=null,Q.value=[]}const Ce=z({__name:"Header",emits:["add-integration"],setup(t,{emit:r}){return(e,n)=>{const u=l("v-col"),s=l("v-btn"),i=l("v-row");return _(),p(i,{class:"mb-4"},{default:o(()=>[a(u,{cols:"12",md:"8"},{default:o(()=>n[1]||(n[1]=[m("h1",{class:"text-h4 font-weight-bold"}," Integrations ",-1),m("p",{class:"text-subtitle-1 text-medium-emphasis"}," Connect and manage external services for your project ",-1)])),_:1,__:[1]}),a(u,{cols:"12",md:"4",class:"text-right"},{default:o(()=>[a(s,{color:"primary","prepend-icon":"mdi-plus",class:"liquid-button",onClick:n[0]||(n[0]=S=>e.$emit("add-integration"))},{default:o(()=>n[2]||(n[2]=[c(" Add Integration ",-1)])),_:1,__:[2]})]),_:1})]),_:1})}}});const ke=U(Ce,[["__scopeId","data-v-a21381ce"]]),Ve={class:"text-h6"},De={class:"text-body-2 mb-3"},Se={key:0,class:"mb-3"},Fe={key:1,class:"integration-stats"},Le={class:"stat-card"},Ae={class:"stat-value"},Ee={class:"stat-card"},ze={class:"stat-value"},Re={class:"stat-card"},Te={class:"stat-value"},Ue=z({__name:"IntegrationCard",props:{integration:{},loading:{type:Boolean}},emits:["connect","sync","configure","view-logs","disconnect"],setup(t,{emit:r}){return(e,n)=>{const u=l("v-icon"),s=l("v-avatar"),i=l("v-chip"),S=l("v-card-title"),I=l("v-list-item-title"),$=l("v-list-item-subtitle"),C=l("v-list-item"),k=l("v-list"),F=l("v-card-text"),y=l("v-btn"),L=l("v-card-actions"),v=l("v-card");return _(),p(v,{class:X(["integration-card glass-card",{connected:e.integration.connected}])},{default:o(()=>[a(S,{class:"d-flex align-center"},{default:o(()=>[a(s,{color:d(ce)(e.integration.type),class:"mr-3",size:"40"},{default:o(()=>[a(u,{icon:d(ue)(e.integration.type)},null,8,["icon"])]),_:1},8,["color"]),m("div",null,[m("div",Ve,g(e.integration.name),1),a(i,{color:e.integration.connected?"success":"warning",size:"small",variant:"tonal"},{default:o(()=>[c(g(e.integration.connected?"Connected":"Disconnected"),1)]),_:1},8,["color"])])]),_:1}),a(F,null,{default:o(()=>[m("p",De,g(e.integration.description),1),e.integration.connected?(_(),R("div",Se,[a(k,{density:"compact"},{default:o(()=>[e.integration.lastSync?(_(),p(C,{key:0},{default:o(()=>[a(I,null,{default:o(()=>n[5]||(n[5]=[c("Last Sync",-1)])),_:1,__:[5]}),a($,null,{default:o(()=>[c(g(d(ve)(e.integration.lastSync)),1)]),_:1})]),_:1})):A("",!0),e.integration.rootFolder?(_(),p(C,{key:1},{default:o(()=>[a(I,null,{default:o(()=>n[6]||(n[6]=[c("Root Folder",-1)])),_:1,__:[6]}),a($,null,{default:o(()=>[c(g(e.integration.rootFolder),1)]),_:1})]),_:1})):A("",!0),e.integration.webhookStatus?(_(),p(C,{key:2},{default:o(()=>[a(I,null,{default:o(()=>n[7]||(n[7]=[c("Webhook Status",-1)])),_:1,__:[7]}),a($,null,{default:o(()=>[a(i,{color:e.integration.webhookStatus==="active"?"success":"warning",size:"x-small"},{default:o(()=>[c(g(e.integration.webhookStatus),1)]),_:1},8,["color"])]),_:1})]),_:1})):A("",!0)]),_:1})])):A("",!0),e.integration.stats?(_(),R("div",Fe,[m("div",Le,[m("div",Ae,g(e.integration.stats.files),1),n[8]||(n[8]=m("div",{class:"stat-label"},"Files",-1))]),m("div",Ee,[m("div",ze,g(e.integration.stats.folders),1),n[9]||(n[9]=m("div",{class:"stat-label"},"Folders",-1))]),m("div",Re,[m("div",Te,g(e.integration.stats.size),1),n[10]||(n[10]=m("div",{class:"stat-label"},"Size",-1))])])):A("",!0)]),_:1}),a(L,null,{default:o(()=>[e.integration.connected?(_(),p(y,{key:1,color:"success",variant:"outlined",loading:e.loading,onClick:n[1]||(n[1]=b=>e.$emit("sync",e.integration))},{default:o(()=>n[12]||(n[12]=[c(" Sync Now ",-1)])),_:1,__:[12]},8,["loading"])):(_(),p(y,{key:0,color:"primary",variant:"flat",loading:e.loading,onClick:n[0]||(n[0]=b=>e.$emit("connect",e.integration))},{default:o(()=>n[11]||(n[11]=[c(" Connect ",-1)])),_:1,__:[11]},8,["loading"])),e.integration.connected?(_(),p(y,{key:2,variant:"text",onClick:n[2]||(n[2]=b=>e.$emit("configure",e.integration))},{default:o(()=>n[13]||(n[13]=[c(" Configure ",-1)])),_:1,__:[13]})):A("",!0),e.integration.connected?(_(),p(y,{key:3,variant:"text",onClick:n[3]||(n[3]=b=>e.$emit("view-logs",e.integration))},{default:o(()=>n[14]||(n[14]=[c(" Logs ",-1)])),_:1,__:[14]})):A("",!0),e.integration.connected?(_(),p(y,{key:4,variant:"text",color:"error",onClick:n[4]||(n[4]=b=>e.$emit("disconnect",e.integration))},{default:o(()=>n[15]||(n[15]=[c(" Disconnect ",-1)])),_:1,__:[15]})):A("",!0)]),_:1})]),_:1},8,["class"])}}});const We=U(Ue,[["__scopeId","data-v-4cb099ca"]]),xe=z({__name:"AvailableIntegrations",props:{availableIntegrations:{}},emits:["add"],setup(t,{emit:r}){return(e,n)=>{const u=l("v-card-title"),s=l("v-icon"),i=l("v-avatar"),S=l("v-list-item-title"),I=l("v-list-item-subtitle"),$=l("v-btn"),C=l("v-list-item"),k=l("v-list"),F=l("v-col"),y=l("v-row"),L=l("v-card-text"),v=l("v-card");return _(),p(v,{class:"mt-6 glass-card"},{default:o(()=>[a(u,null,{default:o(()=>n[0]||(n[0]=[c(" Available Integrations ",-1)])),_:1,__:[0]}),a(L,null,{default:o(()=>[a(y,null,{default:o(()=>[(_(!0),R(q,null,j(e.availableIntegrations,b=>(_(),p(F,{key:b.id,cols:"12",md:"6",lg:"4"},{default:o(()=>[a(k,null,{default:o(()=>[a(C,null,{prepend:o(()=>[a(i,{color:b.color,size:"40"},{default:o(()=>[a(s,{icon:b.icon},null,8,["icon"])]),_:2},1032,["color"])]),append:o(()=>[a($,{color:"primary",variant:"outlined",size:"small",onClick:w=>e.$emit("add",b)},{default:o(()=>n[1]||(n[1]=[c(" Add ",-1)])),_:2,__:[1]},1032,["onClick"])]),default:o(()=>[a(S,null,{default:o(()=>[c(g(b.name),1)]),_:2},1024),a(I,null,{default:o(()=>[c(g(b.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}});const Be=U(xe,[["__scopeId","data-v-600160ae"]]),Ne=z({__name:"AddIntegrationDialog",props:{modelValue:{type:Boolean},newIntegration:{}},emits:["update:modelValue","cancel","proceed"],setup(t,{emit:r}){const e=t,n=r,u=f(e.modelValue);return T(()=>e.modelValue,s=>{u.value=s}),T(u,s=>{n("update:modelValue",s)}),(s,i)=>{const S=l("v-card-title"),I=l("v-text-field"),$=l("v-card-text"),C=l("v-spacer"),k=l("v-btn"),F=l("v-card-actions"),y=l("v-card"),L=l("v-dialog");return _(),p(L,{modelValue:u.value,"onUpdate:modelValue":i[3]||(i[3]=v=>u.value=v),"max-width":"500px"},{default:o(()=>[a(y,{class:"glass-card"},{default:o(()=>[a(S,null,{default:o(()=>i[4]||(i[4]=[c(" Add New Integration ",-1)])),_:1,__:[4]}),a($,null,{default:o(()=>[a(I,{modelValue:s.newIntegration.name,"onUpdate:modelValue":i[0]||(i[0]=v=>s.newIntegration.name=v),label:"Integration Name",required:""},null,8,["modelValue"])]),_:1}),a(F,null,{default:o(()=>[a(C),a(k,{color:"error",variant:"text",onClick:i[1]||(i[1]=v=>s.$emit("cancel"))},{default:o(()=>i[5]||(i[5]=[c(" Cancel ",-1)])),_:1,__:[5]}),a(k,{color:"primary",variant:"flat",onClick:i[2]||(i[2]=v=>s.$emit("proceed"))},{default:o(()=>i[6]||(i[6]=[c(" Continue ",-1)])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const Ge=U(Ne,[["__scopeId","data-v-0b89189b"]]),Oe=z({__name:"ConfigureIntegrationDialog",props:{modelValue:{type:Boolean},selectedIntegration:{},selectedIntegrationRootFolder:{},selectedIntegrationEnableWebhooks:{type:Boolean}},emits:["update:modelValue","update:selectedIntegrationRootFolder","update:selectedIntegrationEnableWebhooks","close","save"],setup(t,{emit:r}){const e=t,n=r,u=f(e.modelValue);return T(()=>e.modelValue,s=>{u.value=s}),T(u,s=>{n("update:modelValue",s)}),(s,i)=>{const S=l("v-card-title"),I=l("v-text-field"),$=l("v-card-text"),C=l("v-spacer"),k=l("v-btn"),F=l("v-card-actions"),y=l("v-card"),L=l("v-dialog");return _(),p(L,{modelValue:u.value,"onUpdate:modelValue":i[3]||(i[3]=v=>u.value=v),"max-width":"600px"},{default:o(()=>[a(y,{class:"glass-card"},{default:o(()=>[a(S,null,{default:o(()=>{var v;return[c(" Configure "+g((v=s.selectedIntegration)==null?void 0:v.name),1)]}),_:1}),a($,null,{default:o(()=>[a(I,{modelValue:s.selectedIntegrationRootFolder,"onUpdate:modelValue":i[0]||(i[0]=v=>s.selectedIntegrationRootFolder=v),label:"Root Folder Path"},null,8,["modelValue"])]),_:1}),a(F,null,{default:o(()=>[a(C),a(k,{color:"error",variant:"text",onClick:i[1]||(i[1]=v=>s.$emit("close"))},{default:o(()=>i[4]||(i[4]=[c(" Cancel ",-1)])),_:1,__:[4]}),a(k,{color:"primary",variant:"flat",onClick:i[2]||(i[2]=v=>s.$emit("save"))},{default:o(()=>i[5]||(i[5]=[c(" Save ",-1)])),_:1,__:[5]})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const Pe=U(Oe,[["__scopeId","data-v-5ed1093b"]]),he={class:"d-flex align-start"},je={class:"log-timestamp"},qe={class:"log-message"},He=z({__name:"LogsDialog",props:{modelValue:{type:Boolean},logsIntegration:{},logs:{}},emits:["update:modelValue","close"],setup(t,{emit:r}){const e=t,n=r,u=f(e.modelValue);return T(()=>e.modelValue,s=>{u.value=s}),T(u,s=>{n("update:modelValue",s)}),(s,i)=>{const S=l("v-card-title"),I=l("v-chip"),$=l("v-list-item"),C=l("v-list"),k=l("v-card-text"),F=l("v-spacer"),y=l("v-btn"),L=l("v-card-actions"),v=l("v-card"),b=l("v-dialog");return _(),p(b,{modelValue:u.value,"onUpdate:modelValue":i[1]||(i[1]=w=>u.value=w),"max-width":"800px"},{default:o(()=>[a(v,{class:"glass-card"},{default:o(()=>[a(S,null,{default:o(()=>{var w;return[c(" Integration Logs - "+g((w=s.logsIntegration)==null?void 0:w.name),1)]}),_:1}),a(k,null,{default:o(()=>[a(C,null,{default:o(()=>[(_(!0),R(q,null,j(s.logs,w=>(_(),p($,{key:w.id,class:X(["log-entry",`log-${w.level}`])},{default:o(()=>[m("div",he,[m("div",je,g(d(me)(w.timestamp)),1),a(I,{color:d(_e)(w.level),size:"x-small",class:"log-level mr-2 mt-1"},{default:o(()=>[c(g(w.level),1)]),_:2},1032,["color"]),m("div",qe,g(w.message),1)])]),_:2},1032,["class"]))),128))]),_:1})]),_:1}),a(L,null,{default:o(()=>[a(F),a(y,{color:"primary",variant:"flat",onClick:i[0]||(i[0]=w=>s.$emit("close"))},{default:o(()=>i[2]||(i[2]=[c(" Close ",-1)])),_:1,__:[2]})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const Me=U(He,[["__scopeId","data-v-c7172aeb"]]),Ke=z({__name:"index",setup(t){return(r,e)=>{const n=l("v-col"),u=l("v-row");return _(),R("div",null,[a(ke,{onAddIntegration:e[0]||(e[0]=s=>E.value=!0)}),a(u,null,{default:o(()=>[(_(!0),R(q,null,j(d(se),s=>(_(),p(n,{key:s.id,cols:"12",md:"6",lg:"4"},{default:o(()=>[a(We,{integration:s,loading:d(D),onConnect:d(te),onSync:d(ge),onConfigure:d(fe),onViewLogs:d(ye),onDisconnect:d(pe)},null,8,["integration","loading","onConnect","onSync","onConfigure","onViewLogs","onDisconnect"])]),_:2},1024))),128))]),_:1}),a(Be,{"available-integrations":d(Y),onAdd:d(be)},null,8,["available-integrations","onAdd"]),a(Ge,{modelValue:d(E),"onUpdate:modelValue":e[1]||(e[1]=s=>P(E)?E.value=s:null),"new-integration":d(B),onCancel:e[2]||(e[2]=s=>E.value=!1),onProceed:d(we)},null,8,["modelValue","new-integration","onProceed"]),a(Pe,{modelValue:d(W),"onUpdate:modelValue":e[3]||(e[3]=s=>P(W)?W.value=s:null),"selected-integration":d(V),"selected-integration-root-folder":d(ae),"selected-integration-enable-webhooks":d(le),onClose:d(oe),onSave:d(Ie)},null,8,["modelValue","selected-integration","selected-integration-root-folder","selected-integration-enable-webhooks","onClose","onSave"]),a(Me,{modelValue:d(x),"onUpdate:modelValue":e[4]||(e[4]=s=>P(x)?x.value=s:null),"logs-integration":d(M),logs:d(Q),onClose:d($e)},null,8,["modelValue","logs-integration","logs","onClose"])])}}});export{Ke as default};
