import{r as _,ai as H,M as G,v as P,a4 as s,a6 as x,a7 as R,a8 as i,A as t,E as O,w as F,_ as y,a2 as k,ab as J,u as f,a as I}from"./vue-3f691d55.js";import{c as L,u as T,a as K}from"./index-cc140e55.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import"./apollo-30a378f4.js";import"./supabase-cf010ec4.js";const S=_("profile"),j=L(),U=T(),Q=H();var $,B;const W=_({name:(($=j.user)==null?void 0:$.name)||"",avatar:((B=j.user)==null?void 0:B.avatar)||""});var q,C,E;const X=_({email:((q=j.notificationPrefs)==null?void 0:q.email)||!1,sms:((C=j.notificationPrefs)==null?void 0:C.sms)||!1,inApp:((E=j.notificationPrefs)==null?void 0:E.inApp)||!1}),A=_({name:"",templates:[],autoApprove:!1}),M=[a=>!!a||"Name is required"],Y=[a=>!a||/^https?:\/\//.test(a)||"Must be a valid URL"];async function Z(){var l,n;U.projects.length||await U.fetchProjects();const a=U.projects.find(u=>u.id===Q.params.id);a&&(A.value.name=a.name,A.value.templates=((l=a.settings)==null?void 0:l.templates)||[],A.value.autoApprove=((n=a.settings)==null?void 0:n.autoApprove)||!1)}function h(){G(async()=>{await Z()})}const z=L(),V=K(),ee=T();async function te(a){try{await z.updateProfile(a),V.add("success","Profile updated")}catch(l){throw V.add("error","Failed to update profile"),l}}async function oe(a){try{await z.updateNotificationPrefs(a),V.add("success","Notification preferences saved")}catch(l){throw V.add("error","Failed to save notifications"),l}}async function ae(a,l){try{await ee.updateProjectOptions(a,{name:l.name,templates:l.templates,autoApprove:l.autoApprove}),V.add("success","Project settings saved")}catch(n){throw V.add("error","Failed to save project settings"),n}}const ne=P({__name:"SettingsHeader",setup(a){return(l,n)=>{const u=s("v-col"),e=s("v-row");return x(),R(e,{class:"mb-4"},{default:i(()=>[t(u,{cols:"12"},{default:i(()=>n[0]||(n[0]=[O("h1",{class:"text-h4 font-weight-bold"}," Settings ",-1),O("p",{class:"text-subtitle-1 text-medium-emphasis"}," Manage your profile, notifications, and project settings ",-1)])),_:1,__:[0]})]),_:1})}}});const se=N(ne,[["__scopeId","data-v-9dbd9614"]]),le=P({__name:"ProfileSettings",props:{profile:{},nameRules:{},urlRules:{}},emits:["update:profile","save"],setup(a,{emit:l}){const n=a,u=l,e=_({...n.profile}),p=_();async function r(){const{valid:c}=await p.value.validate();c&&(u("save",e.value),u("update:profile",e.value))}return F(()=>n.profile,()=>{e.value={...n.profile}}),(c,o)=>{const d=s("v-text-field"),b=s("v-btn"),v=s("v-card"),w=s("v-form");return x(),R(w,{ref_key:"profileForm",ref:p,onSubmit:k(r,["prevent"])},{default:i(()=>[t(v,{class:"glass-card pa-4 mb-4"},{default:i(()=>[t(d,{modelValue:e.value.name,"onUpdate:modelValue":o[0]||(o[0]=m=>e.value.name=m),label:"Name",rules:c.nameRules,required:""},null,8,["modelValue","rules"]),t(d,{modelValue:e.value.avatar,"onUpdate:modelValue":o[1]||(o[1]=m=>e.value.avatar=m),label:"Avatar URL",rules:c.urlRules},null,8,["modelValue","rules"]),t(b,{type:"submit",color:"primary"},{default:i(()=>o[2]||(o[2]=[y(" Save ",-1)])),_:1,__:[2]})]),_:1})]),_:1},512)}}});const ie=N(le,[["__scopeId","data-v-c8735bf1"]]),re=P({__name:"NotificationSettings",props:{notif:{}},emits:["update:notif","save"],setup(a,{emit:l}){const n=a,u=l,e=_({...n.notif}),p=_();async function r(){u("save",e.value),u("update:notif",e.value)}return F(()=>n.notif,()=>{e.value={...n.notif}}),(c,o)=>{const d=s("v-switch"),b=s("v-btn"),v=s("v-card"),w=s("v-form");return x(),R(w,{ref_key:"notifForm",ref:p,onSubmit:k(r,["prevent"])},{default:i(()=>[t(v,{class:"glass-card pa-4 mb-4"},{default:i(()=>[t(d,{modelValue:e.value.email,"onUpdate:modelValue":o[0]||(o[0]=m=>e.value.email=m),label:"Email"},null,8,["modelValue"]),t(d,{modelValue:e.value.sms,"onUpdate:modelValue":o[1]||(o[1]=m=>e.value.sms=m),label:"SMS"},null,8,["modelValue"]),t(d,{modelValue:e.value.inApp,"onUpdate:modelValue":o[2]||(o[2]=m=>e.value.inApp=m),label:"In-App"},null,8,["modelValue"]),t(b,{type:"submit",color:"primary"},{default:i(()=>o[3]||(o[3]=[y(" Save ",-1)])),_:1,__:[3]})]),_:1})]),_:1},512)}}});const ue=N(re,[["__scopeId","data-v-e47eace5"]]),pe=P({__name:"ProjectSettings",props:{projectOptions:{},nameRules:{}},emits:["update:projectOptions","save"],setup(a,{emit:l}){const n=a,u=l,e=_({...n.projectOptions}),p=_();async function r(){const{valid:c}=await p.value.validate();c&&(u("save",e.value),u("update:projectOptions",e.value))}return F(()=>n.projectOptions,()=>{e.value={...n.projectOptions}}),(c,o)=>{const d=s("v-text-field"),b=s("v-combobox"),v=s("v-switch"),w=s("v-btn"),m=s("v-card"),D=s("v-form");return x(),R(D,{ref_key:"projectForm",ref:p,onSubmit:k(r,["prevent"])},{default:i(()=>[t(m,{class:"glass-card pa-4 mb-4"},{default:i(()=>[t(d,{modelValue:e.value.name,"onUpdate:modelValue":o[0]||(o[0]=g=>e.value.name=g),label:"Project Name",rules:c.nameRules,required:""},null,8,["modelValue","rules"]),t(b,{modelValue:e.value.templates,"onUpdate:modelValue":o[1]||(o[1]=g=>e.value.templates=g),label:"Templates",multiple:"",chips:"","hide-selected":""},null,8,["modelValue"]),t(v,{modelValue:e.value.autoApprove,"onUpdate:modelValue":o[2]||(o[2]=g=>e.value.autoApprove=g),label:"Auto-approve tasks"},null,8,["modelValue"]),t(w,{type:"submit",color:"primary"},{default:i(()=>o[3]||(o[3]=[y(" Save ",-1)])),_:1,__:[3]})]),_:1})]),_:1},512)}}});const ce=N(pe,[["__scopeId","data-v-2748071c"]]),de=P({__name:"SettingsView",setup(a){h();const l=H();async function n(p){await te(p)}async function u(p){await oe(p)}async function e(p){await ae(l.params.id,p)}return(p,r)=>{const c=s("v-tab"),o=s("v-tabs"),d=s("v-window-item"),b=s("v-window");return x(),J("div",null,[t(se),t(o,{modelValue:f(S),"onUpdate:modelValue":r[0]||(r[0]=v=>I(S)?S.value=v:null),density:"compact",class:"mb-4"},{default:i(()=>[t(c,{value:"profile"},{default:i(()=>r[2]||(r[2]=[y(" Profile ",-1)])),_:1,__:[2]}),t(c,{value:"notifications"},{default:i(()=>r[3]||(r[3]=[y(" Notifications ",-1)])),_:1,__:[3]}),t(c,{value:"project"},{default:i(()=>r[4]||(r[4]=[y(" Project ",-1)])),_:1,__:[4]})]),_:1},8,["modelValue"]),t(b,{modelValue:f(S),"onUpdate:modelValue":r[1]||(r[1]=v=>I(S)?S.value=v:null)},{default:i(()=>[t(d,{value:"profile"},{default:i(()=>[t(ie,{profile:f(W),"name-rules":f(M),"url-rules":f(Y),onSave:n},null,8,["profile","name-rules","url-rules"])]),_:1}),t(d,{value:"notifications"},{default:i(()=>[t(ue,{notif:f(X),onSave:u},null,8,["notif"])]),_:1}),t(d,{value:"project"},{default:i(()=>[t(ce,{"project-options":f(A),"name-rules":f(M),onSave:e},null,8,["project-options","name-rules"])]),_:1})]),_:1},8,["modelValue"])])}}});const Se=N(de,[["__scopeId","data-v-6cf8536a"]]);export{Se as default};
